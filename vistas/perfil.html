<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mi Perfil</title>
</head>
<body>
  <h1>Mi Perfil</h1>
  <div id="perfil-usuario">
    Cargando...
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCpxDBpbRULGy79ID_KySe2wjj1T-szhJI",
      authDomain: "integradora10a-6bf01.firebaseapp.com",
      databaseURL: "https://integradora10a-6bf01-default-rtdb.firebaseio.com",
      projectId: "integradora10a-6bf01",
      storageBucket: "integradora10a-6bf01.appspot.com",
      messagingSenderId: "791116131611",
      appId: "1:791116131611:web:4db9820ecab328410eb7be"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);
    const perfilDiv = document.getElementById('perfil-usuario');

    onAuthStateChanged(auth, user => {
      if (user) {
        const uid = user.uid;
        const userRef = ref(db, 'usuarios/' + uid);
        get(userRef).then(snapshot => {
          if (snapshot.exists()) {
            const datos = snapshot.val();
            perfilDiv.innerHTML = `
              <p><strong>Correo:</strong> ${datos.Email}</p>
              <p><strong>Rol:</strong> ${datos.Rol}</p>
              <p><strong>UID:</strong> ${datos.Key}</p>
            `;
          } else {
            perfilDiv.textContent = "No se encontraron datos del usuario.";
          }
        }).catch(error => {
          perfilDiv.textContent = "Error al cargar el perfil.";
          console.error(error);
        });
      } else {
        perfilDiv.textContent = "No est√°s autenticado.";
      }
    });
  </script>
</body>
</html>
